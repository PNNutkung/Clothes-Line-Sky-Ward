<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf8">
      <title>Clothesline Sky Ward</title>
      <link href="bootstrap-3.3.5-dist/css/bootstrap.min.css" rel="stylesheet">
      <link rel="stylesheet" href="bootstrap-material-design/dist/css/ripples.min.css">
      <link rel="stylesheet" href="bootstrap-material-design/dist/css/material-fullpalette.css">
      <link rel="stylesheet" href="bootstrap-material-design/dist/css/roboto.min.css">
      <link rel="stylesheet" href="animate.css">
      <link rel="stylesheet" href="style.css">
   </head>
   <body>
      <script src="jquery-2.1.4.min.js"></script>
      <!-- NOTE: Load Data -->
      <script>
         //NOTE: Hide unused page
         $("#main-page").hide();
         //NOTE: Server Element Variable
         var user_list;
         var pass_list;
         var mode;
         var temp;
         var rain;
         var state;
        var light;
          var pos;
         //NOTE: Group of resource loader function
         //NOTE: Load list of id
         function onLoadedUserList(result){
             user_list = result.split(",")
         }
         //NOTE: Load password list
         function onLoadedPasswordList(result){
             pass_list = result.split(",")
         }
         //NOTE: Load data
         function onLoadedData(result){
             var result_list = result.split("_")
             temp = result_list[0]
             rain = result_list[1]
             mode = result_list[2]
             state = result_list[3]
             light = result_list[4]
             pos = result_list[5]
         }
         
         //NOTE: Load every reaource
         function loadResource(){
             $.get("http://exceed.cupco.de/iot/SeatBelt/clsw-user-list",onLoadedUserList);
             $.get("http://exceed.cupco.de/iot/SeatBelt/clsw-pass-list",onLoadedPasswordList);
             $.get("http://exceed.cupco.de/iot/SeatBelt/board",onLoadedData);
             console.log(mode)
         }
         loadResource();
      </script>
      <!-- NOTE: head-page -->
      <div class="container ">
         <div class="jumbotron header">
            <div class="row">
               <div class="col-md-12">
                  <h1>Clothesline Sky Ward</h1>
               </div>
            </div>
         </div>
      </div>
      
      <!-- NOTE: Nav-bar -->
      <div class="container" id="nav-part">
          <div class="row">
              <div class="col-md-12">
                  <div class="navbar navbar-inverse">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand active" href="javascript:void(0)">ClotheslineSkyWard</a>
    </div>
    <div class="navbar-collapse collapse navbar-responsive-collapse">
        <ul class="nav navbar-nav">
            <li class="active"><a href="javascript:void(0)">Home</a></li>
            <li><a href="spec.html">Specification</a></li>
            <li><a href="hero.html">Hero</a></li>
            
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li><a href="about.html">About us</a></li>
            <li><a href="https://github.com/PNNutkung/Clothes-Line-Sky-Ward/ " target="_blank">GitHub</a></li>
        </ul>
    </div>
</div>
              </div>
          </div>
      </div>
      
      <!-- NOTE: front-page -->
      <div class="container" id="front-page">
         <script>$("#front-page").hide()</script>
         <div class="jumbotron">
            <!-- NOTE: Login failed -->
            <div class="alert alert-dismissable alert-danger">
               <button type="button" class="close" data-dismiss="alert">Ã—</button>
               <strong>Invalid</strong> username or password.
            </div>
            <!-- NOTE: /Login failed -->
            <div class="row rowID">
               <div class="col-md-2 col-sm-2 IDtext text-center">
                  <h4>Username</h4>
               </div>
               <div class="col-md-8 col-sm-8 inputText">
                  <!-- NOTE: user-input -->
                  <form id="formID">
                  <input type="text" class="form-control" id="user-input" placeholder="input your username" style="font-size:20px">
                   </form>
               </div>
            </div>
            <div class="row rowID">
               <div class="col-md-2 col-sm-2 IDtext text-center">
                  <h4>Password</h4>
               </div>
               <div class="col-md-8 col-sm-8 inputText">
                  <!-- NOTE: pass-input -->
                  <form id="formPass">
                  <input type="password" class="form-control" id="pass-input" placeholder="input your password" style="font-size:20px">
                  </form>
               </div>
            </div>
            <div class="row text-center">
               <!-- NOTE: register-btn -->
               <a type="button" class="btn btn-primary" id="register-btn" style="font-size:20px" href="regis.html">Register</a>
               <!-- NOTE: login-btn -->
               <button type="button" class="btn btn-success btn-raised" id="login-btn" style="font-size:20px">Login</button>
            </div>
         </div>
      </div>
      
      <!-- NOTE: main-page -->
      <div class="container maincontent" id="main-page" >
        <div class="jumbotron" style ="background-color: #F8F8F8;">
         <script>$("#main-page").hide()</script>
         <div class="row">
            <!-- NOTE: humidity label -->
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
               <div class="jumbotron">
                  <div class="carousel slide" data-ride="carousel">
                     <div class="carousel-inner">
                        <div class="item active">
                           <!-- TODO: Find new picture -->
                           <img src="images/sun1.png" alt="" class="img-responsive weather-img" id="li-img">
                           <div class="text-center weather-text" id="li">
                              Humidity: 0
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <!-- NOTE: rain status -->
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
               <div class="jumbotron">
                  <div class="carousel slide" data-ride="carousel">
                     <div class="carousel-inner">
                        <div class="item active">
                           <!-- TODO: Find new picture -->
                           <img src="images/sun6.png" alt="" class="img-responsive weather-img" id="rain-img">
                           <div class="text-center weather-text" id="rain">
                              Rain
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <div class="row">
            <!-- NOTE: humidity label -->
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
               <div class="jumbotron">
                  <div class="carousel slide" data-ride="carousel">
                     <div class="carousel-inner">
                        <div class="item active">
                           <!-- TODO: Find new picture -->
                           <img src="images/temperature.png" alt="" class="img-responsive weather-img" id="temperature-img">
                           <div class="text-center weather-text" id="degree">
                              0 Celcieus
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <!-- NOTE: rain status -->
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
               <div class="jumbotron">
                  <div class="carousel slide" data-ride="carousel">
                     <div class="carousel-inner">
                        <div class="item active">
                           <!-- TODO: Find new picture -->
                           <img src="images/cloth-out.png" alt="" class="img-responsive weather-img" id="dryclothes-img">
                           <div class="text-center weather-text" id="dryclothes">
                              Outdoor
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <div class="row">
            <!-- NOTE: galileo status -->
            <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3">
               <div class="well well-md" id="state">Outdoor</div>
            </div>
         </div>
         <div class="row">
            <!-- NOTE: state-btn -->
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
               <button href="javascript:void(0)" class="btn btn-success" id="state-btn" style="font-size:30px">Pull Back</button>
            </div>
            <!-- NOTE: auto-btn -->
            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
               <a href="javascript:void(0)" class="btn btn-warning disabled" id="auto-btn" style="font-size:30px">Auto</a>
            </div>
         </div>
         <div class="row">
            <!-- NOTE: logout-btn -->
            <div class="col-md-12">
               <button href="javascript:void(0)" class="btn btn-danger" id="logout-btn" style="font-size:20px">Logout</button>
            </div>
         </div>
      </div>
      </div>
      <!-- NOTE: Jumbotron -->
      <script src="bootstrap-material-design\dist\js\ripples.min.js"></script>
      <script src="bootstrap-material-design\dist\js\material.min.js"></script>
      <script>
         $(document).ready(function() {
             // This command is used to initialize some elements and make them work properly
             $.material.init();
         });
      </script>
      <script>
         $(".alert").hide();
         $("#front-page").fadeIn()
         //NOTE: Page Variable
         var front_page = $("#front-page")
         var main_page = $("#main-page")
         //NOTE: Local Element Variable
         var user;
         var pass;
         var num_current;
         var interval = setInterval(refresh,1000);
         //NOTE: Boolean Variable
         var isLogin = false;
         //NOTE: Boolean Function
         //NOTE: Check ID and pass
         function checkAccount(){
             user = $("#user-input").val()
             pass = $("#pass-input").val()
             for (var i =0;i<user_list.length;i++) {
                 if (user===user_list[i]&&pass===pass_list[i]) {
                     num_current = i;
                     return true;
                 }
             }
             num_current = -1;
             return false
         }
         //NOTE: Switching function
         //NOTE: Switch to Main Page
         function goToMainPage(){
             $(".alert").hide();
             if (checkAccount()) {
                 $("#user-input").removeClass("animated shake");
                 $("#pass-input").removeClass("animated shake");
                 front_page.fadeOut()
                 main_page.fadeIn()
                 isLogin = true;
                 $("#user-input").val('')
                 $("#pass-input").val('')
            }
            else{
                 $(".alert").fadeIn();
                 $("#user-input").addClass("animated shake");
                 $("#pass-input").addClass("animated shake");
             }
         }
         //NOTE: Switch to Front Page
         function goToFrontPage(){
             isLogin = false
             clearInterval(interval)
             main_page.fadeOut();
             front_page.fadeIn();
         }
         //NOTE: refresh to update state
         function refresh(){
             loadResource();
                          console.log(state)
             if (isLogin) {
                 updateGUI();
             }
         }
         //NOTE: Action Function
         //NOTE: Update GUI
             function updateGUI(){
             $("#state").text(state);
             if (rain==0) {
                 $("#rain").text("Raining")
                 $("#rain-img").attr("src","images/sun6.png")
             }
             else {  
                 $("#rain").text("Dry")
                 $("#rain-img").attr("src","images/sun.png")
             }
             $("#degree").text(temp+" Celcius")
             $("#li").text("Light Intensity: "+light)
             if (temp<25) {
                 $("#temperature-img").attr("src","images/temperature2.png")
             }
             else {  
                 $("#temperature-img").attr("src","images/temperature.png")
             }
             if (light>=600) {
                 $("#li-img").attr("src","images/sun1.png")
             }
             else if (light<600 && light>=300) {
                 $("#li-img").attr("src","images/sun2.png")
             }
             else if (light>50 && light<300) {
                 $("#li-img").attr("src","images/sun3.png")
             }
             else {
                 $("#li-img").attr("src","images/sun4.png")
             }
             if (state==1){
                 $("#state").text("Outdoor");
                 $("#state-btn").text("PULL BACK");
                 $("#dryclothes").text("Outdoor");
                 $("#dryclothes-img").attr("src","images/cloth-out.png")
             }
             else {
                 $("#state").text("Indoor");
                 $("#state-btn").text("EXTEND")
                 $("#dryclothes").text("Indoor");
                 $("#dryclothes-img").attr("src","images/umbrella.png")
             }
             if (mode=="M") {
                 $("#auto-btn").removeClass("btn-warning disabled")
                 $("#auto-btn").addClass("btn-info")
                 $("#auto-btn").addClass("btn-raised")
             }
             else {
                 $("#auto-btn").toggleClass("btn btn-info btn-raised")
                 $("#auto-btn").addClass("btn btn-warning disabled")
             }
         }
         //NOTE: Change button color and text when change state and post data to server
         function postState(){
             if (state==1) {
                 state=0
             }
             else {
                 state=1
             }
             mode = "M";
             var dat = mode+"_"+state
             $.post("http://exceed.cupco.de/iot/SeatBelt/web",{data:dat},console.log('a'))
         }
         function hide() {
             $(".alert").hide();
         }
         function changeToAuto(){
             mode = "A";
             var dat = mode
             $.post("http://exceed.cupco.de/iot/SeatBelt/web",{data:dat},console.log(mode))
         }
         function enterToLogin(){
             goToMainPage();
             return false;
         }
         //Button ActionListener
         $(".close").click(hide);
         $("#login-btn").click(goToMainPage)
         $("#logout-btn").click(goToFrontPage)
         $("#auto-btn").click(changeToAuto);
         $("#state-btn").click(postState);
         $("#formID").submit(enterToLogin);
         $("#formPass").submit(enterToLogin);
      </script>
   </body>
</html>